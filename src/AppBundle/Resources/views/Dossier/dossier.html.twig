{% extends 'base.html.twig' %}
{% block body %}
    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
        <div class="panel panel-default">
            <div class="panel-heading" role="tab" id="headingOne">
                <h4 class="panel-title">
                    <a class="collapsed" data-toggle="collapse" href="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                        <h4>{{ 'app.dossier.action_required'|trans }}</h4>
                    </a>
                </h4>
            </div>
            <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="panel-body">
                    {% form_theme form_action 'AppBundle:Form:admin.html.twig' %}
                    {{ form_start(form_action) }}
                    <div id="action-toolbar">
                        <div class="columns-right btn-group pull-left">
                            {{ form_widget(form_action.add) }}
                            {{ form_widget(form_action.edit) }}
                            {{ form_widget(form_action.delete) }}
                            {{ form_widget(form_action.lock) }}
                        </div>
                    </div>

                    <table class="table table-striped table-bordered table-hover" data-search="true" data-toggle="table" data-show-columns="true" data-select-item-name="dossier_action" data-toolbar="#action-toolbar" data-pagination="true" data-show-export="true">
                        <thead>
                        <tr>
                            <th data-sortable="false" data-align="center" data-switchable="false"></th>
                            <th data-sortable="true" data-field="title" >{{ 'app.dossier.title'|trans }}</th>
                            <th data-sortable="true" data-field="description" >{{ 'app.dossier.description'|trans }}</th>
                            <th data-sortable="true" data-field="author" >{{ 'app.dossier.author'|trans }}</th>
                            <th data-sortable="true" data-field="status" >{{ 'app.dossier.status'|trans }}</th>
                            <th data-sortable="true" style="display: block" data-field="date" >{{ 'app.dossier.date'|trans }}</th>
                            <th data-sortable="true" data-field="deadline" >{{ 'app.dossier.deadline'|trans }}</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for item in form_action.dossiers %}
                            <tr>
                                <td>{{ form_row(item, { 'label': ' ' }) }}</td>
                                <td>{{ dossiers[loop.index-1].name }}</td>
                                <td>{{ dossiers[loop.index-1].description|length > 90 ? dossiers[loop.index-1].description|slice(0, 90) ~ '...' : dossiers[loop.index-1].description }}</td>
                                <td>{{ get_groups(dossiers[loop.index-1].author)|raw }}</td>
                                <td>{{ 'app.dossier.statusid'|transchoice(dossiers[loop.index-1].status) }}</td>
                                <td>{{ dossiers[loop.index-1].dateCreated|date('d/m/Y') }}</td>
                                <td></td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    {% do form_action.dossiers.setRendered %}
                    {{ form_end(form_action) }}
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading" role="tab" id="headingTwo">
                <h4 class="panel-title">
                    <a class="collapsed" data-toggle="collapse" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        <h4>{{  'app.dossier.my_dossiers'|trans }}</h4>
                    </a>
                </h4>
            </div>
            <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                <div class="panel-body">
                    {% form_theme form_my 'AppBundle:Form:admin.html.twig' %}
                    {{ form_start(form_my) }}
                    <div id="my-toolbar">
                        <div class="columns-right btn-group pull-left">
                            {{ form_widget(form_my.add) }}
                            {{ form_widget(form_my.edit) }}
                            {{ form_widget(form_my.delete) }}
                            {{ form_widget(form_my.lock) }}
                        </div>
                    </div>

                    <table class="table table-striped table-bordered table-hover" data-search="true" data-toggle="table" data-show-columns="true" data-select-item-name="dossier_my" data-toolbar="#my-toolbar" data-pagination="true" data-show-export="true">
                        <thead>
                        <tr>
                            <th data-sortable="false" data-align="center" data-switchable="false"></th>
                            <th data-sortable="true" data-field="title" >{{ 'app.dossier.title'|trans }}</th>
                            <th data-sortable="true" data-field="description" >{{ 'app.dossier.description'|trans }}</th>
                            <th data-sortable="true" data-field="author" >{{ 'app.dossier.author'|trans }}</th>
                            <th data-sortable="true" data-field="status" >{{ 'app.dossier.status'|trans }}</th>
                            <th data-sortable="true" data-field="date" >{{ 'app.dossier.date'|trans }}</th>
                            <th data-sortable="true" data-field="deadline" >{{ 'app.dossier.deadline'|trans }}</th>
                        </tr>
                        </thead>
                        <tbody>

                        {% for item in form_my.dossiers %}
                            {% set id = item.vars.name %}

                        {% endfor %}
                        </tbody>
                    </table>
                    {% do form_my.dossiers.setRendered %}
                    {{ form_end(form_my) }}
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading" role="tab" id="headingThree">
                <h4 class="panel-title">
                    <a class="collapsed" data-toggle="collapse" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                        <h4>{{  'app.dossier.other_dossiers'|trans }}</h4>
                    </a>
                </h4>
            </div>
            <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                <div class="panel-body">
                    {% form_theme form_others 'AppBundle:Form:admin.html.twig' %}
                    {{ form_start(form_others) }}
                    <div id="others-toolbar">
                        <div class="columns-right btn-group pull-left">
                            {{ form_widget(form_others.add) }}
                            {{ form_widget(form_others.edit) }}
                            {{ form_widget(form_others.delete) }}
                            {{ form_widget(form_others.lock) }}
                        </div>
                    </div>

                    <table class="table table-striped table-bordered table-hover" data-search="true" data-toggle="table" data-show-columns="true" data-select-item-name="others-toolbar" data-toolbar="#dossier-others" data-pagination="true" data-show-export="true">
                        <thead>
                        <tr>
                            <th data-sortable="false" data-align="center" data-switchable="false"></th>
                            <th data-sortable="true" data-field="title" >{{ 'app.dossier.title'|trans }}</th>
                            <th data-sortable="true" data-field="description" >{{ 'app.dossier.description'|trans }}</th>
                            <th data-sortable="true" data-field="author" >{{ 'app.dossier.author'|trans }}</th>
                            <th data-sortable="true" data-field="status" >{{ 'app.dossier.status'|trans }}</th>
                            <th data-sortable="true" data-field="date" >{{ 'app.dossier.date'|trans }}</th>
                            <th data-sortable="true" data-field="deadline" >{{ 'app.dossier.deadline'|trans }}</th>
                        </tr>
                        </thead>
                        <tbody>

                        {% for item in form_others.dossiers %}
                            {% set id = item.vars.name %}

                        {% endfor %}
                        </tbody>
                    </table>
                    {% do form_others.dossiers.setRendered %}
                    {{ form_end(form_others) }}
                </div>
            </div>
        </div>
    </div>
{% endblock %}